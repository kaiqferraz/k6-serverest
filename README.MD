# ğŸš€ K6 Serverest - Testes de Performance

Este projeto implementa testes de performance usando **K6** para a API **Serverest**, permitindo avaliar o comportamento e a capacidade de resposta da aplicaÃ§Ã£o sob diferentes cargas de usuÃ¡rios.

## ğŸ“‹ DescriÃ§Ã£o

O projeto realiza testes de carga progressiva na API Serverest, testando endpoints especÃ­ficos como produtos, com mÃ©tricas de performance configuradas para garantir qualidade e estabilidade da aplicaÃ§Ã£o.

## ğŸ¯ Objetivos

- **Teste de Carga Progressiva**: Avaliar performance com aumento gradual de usuÃ¡rios
- **MÃ©tricas de Qualidade**: Garantir tempos de resposta adequados
- **RelatÃ³rios HTML**: Gerar relatÃ³rios visuais dos resultados dos testes
- **ConfiguraÃ§Ã£o FlexÃ­vel**: Suporte para ambientes local e de produÃ§Ã£o

## ğŸ—ï¸ Estrutura do Projeto

```
k6-serverest/
â”œâ”€â”€ README.MD              # DocumentaÃ§Ã£o do projeto
â”œâ”€â”€ serverest.js           # Script principal de teste K6
â”œâ”€â”€ summary.html           # RelatÃ³rio HTML gerado automaticamente
â””â”€â”€ utils/
    â””â”€â”€ serverestUtils.js  # ConfiguraÃ§Ãµes e endpoints da API
```

## âš™ï¸ PrÃ©-requisitos

- [Node.js](https://nodejs.org/) (versÃ£o 16 ou superior)
- [K6](https://k6.io/docs/getting-started/installation/) instalado no sistema
- API Serverest rodando (local ou remota)

## ğŸš€ InstalaÃ§Ã£o

### 1. Instalar K6

#### Windows (via Chocolatey):

```bash
choco install k6
```

#### Windows (via Scoop):

```bash
scoop install k6
```

#### Windows (via MSI):

Baixe o instalador MSI da [pÃ¡gina oficial do K6](https://k6.io/docs/getting-started/installation/)

### 2. Verificar InstalaÃ§Ã£o

```bash
k6 version
```

## âš¡ ConfiguraÃ§Ã£o

### Endpoints da API

O projeto suporta dois ambientes configurados em `utils/serverestUtils.js`:

- **Local**: `http://localhost:3000/`
- **ProduÃ§Ã£o**: `https://serverest.dev/`

Para alterar o ambiente, edite o arquivo `utils/serverestUtils.js`:

```javascript
export const ENDPOINTS = {
  urlBase: "https://serverest.dev/", // ProduÃ§Ã£o
  urlBaseLocalHost: "http://localhost:3000/", // Local
  urlProdutos: "produtos",
};
```

## ğŸ§ª Executando os Testes

### ExecuÃ§Ã£o BÃ¡sica

```bash
k6 run serverest.js
```

### ExecuÃ§Ã£o com VariÃ¡veis de Ambiente

```bash
k6 run -e ENVIRONMENT=local serverest.js
```

### ExecuÃ§Ã£o com ConfiguraÃ§Ãµes Customizadas

```bash
k6 run --out json=results.json serverest.js
```

## ğŸ“Š ConfiguraÃ§Ã£o dos Testes

### CenÃ¡rios de Teste

O projeto utiliza um cenÃ¡rio de **ramping VUs** (Virtual Users) com as seguintes etapas:

1. **Rampa de Subida**: 0 â†’ 500 usuÃ¡rios em 2 minutos
2. **EstabilizaÃ§Ã£o**: 500 â†’ 1000 usuÃ¡rios em 2 minutos
3. **Pico de Carga**: 1000 â†’ 1500 usuÃ¡rios em 2 minutos
4. **Rampa de Descida**: 1500 â†’ 0 usuÃ¡rios em 2 minutos

**DuraÃ§Ã£o Total**: 8 minutos

### Thresholds (Limites de Qualidade)

- **IteraÃ§Ãµes**: MÃ­nimo de 5000 execuÃ§Ãµes
- **Tempo de Resposta**:
  - MÃ©dia < 1000ms (1 segundo)
  - 95% das requisiÃ§Ãµes < 2000ms (2 segundos)
- **Taxa de Falha**: < 1% (0.01)

## ğŸ“ˆ RelatÃ³rios

### RelatÃ³rio HTML AutomÃ¡tico

O projeto gera automaticamente um relatÃ³rio HTML (`summary.html`) apÃ³s cada execuÃ§Ã£o, contendo:

- GrÃ¡ficos de performance
- MÃ©tricas detalhadas
- AnÃ¡lise de tendÃªncias
- ComparaÃ§Ã£o de resultados

### Acessando o RelatÃ³rio

ApÃ³s a execuÃ§Ã£o dos testes, abra o arquivo `summary.html` em qualquer navegador web.

## ğŸ”§ PersonalizaÃ§Ã£o

### Modificando CenÃ¡rios

Para alterar os cenÃ¡rios de teste, edite o arquivo `serverest.js`:

```javascript
export const options = {
  scenarios: {
    custom: {
      executor: "ramping-vus",
      stages: [
        { duration: "1m", target: 100 }, // 0 â†’ 100 usuÃ¡rios em 1 min
        { duration: "2m", target: 100 }, // Manter 100 usuÃ¡rios por 2 min
        { duration: "1m", target: 0 }, // Reduzir para 0 usuÃ¡rios
      ],
    },
  },
  // ... outros parÃ¢metros
};
```

### Adicionando Novos Endpoints

Para testar novos endpoints, adicione-os em `utils/serverestUtils.js`:

```javascript
export const ENDPOINTS = {
  // ... endpoints existentes
  urlUsuarios: "usuarios",
  urlCarrinhos: "carrinhos",
};
```

E implemente os testes em `serverest.js`:

```javascript
export default function () {
  // Teste de produtos
  const res1 = http.get(
    `${ENDPOINTS.urlBaseLocalHost}${ENDPOINTS.urlProdutos}`
  );
  check(res1, {
    "Status da requisiÃ§Ã£o Produtos Ã© 200": (r) => r.status === 200,
  });

  // Teste de usuÃ¡rios
  const res2 = http.get(
    `${ENDPOINTS.urlBaseLocalHost}${ENDPOINTS.urlUsuarios}`
  );
  check(res2, {
    "Status da requisiÃ§Ã£o UsuÃ¡rios Ã© 200": (r) => r.status === 200,
  });

  sleep(0.5);
}
```

## ğŸ“ Logs e Debug

### Habilitando Logs

Para ver logs detalhados durante a execuÃ§Ã£o, descomente as linhas em `serverest.js`:

```javascript
// console.log("Chamada da API retornou o status: " + res1.status);
// console.log("URL da requisiÃ§Ã£o: " + res1.request.url);
```

### Verbose Mode

Execute com modo verbose para mais detalhes:

```bash
k6 run --verbose serverest.js
```

## ğŸ› Troubleshooting

### Problemas Comuns

1. **K6 nÃ£o encontrado**: Verifique se o K6 estÃ¡ instalado e no PATH
2. **API nÃ£o responde**: Confirme se a API Serverest estÃ¡ rodando
3. **Erro de certificado**: Para HTTPS, pode ser necessÃ¡rio configurar certificados
4. **Porta ocupada**: Verifique se a porta 3000 nÃ£o estÃ¡ sendo usada por outro serviÃ§o

### VerificaÃ§Ãµes de DiagnÃ³stico

```bash
# Testar conectividade com a API
curl http://localhost:3000/produtos

# Verificar status do K6
k6 version

# Executar teste simples
k6 run --no-usage-report serverest.js
```

## ğŸ“š Recursos Adicionais

- [DocumentaÃ§Ã£o Oficial do K6](https://k6.io/docs/)
- [Serverest API Documentation](https://serverest.dev/)
- [K6 Examples](https://github.com/grafana/k6-examples)
- [Performance Testing Best Practices](https://k6.io/docs/testing-guides/)

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a MIT. Veja o arquivo `LICENSE` para mais detalhes.

## ğŸ‘¥ Autores

- **Desenvolvedor**: [Kaique Ferraz]
- **Projeto**: K6 Serverest Performance Tests
- **Data**: 2025

---

**â­ Se este projeto foi Ãºtil, considere dar uma estrela no repositÃ³rio!**
